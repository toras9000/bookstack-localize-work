# BookStack ローカライズ作業環境

このリポジトリは BookStack のローカライズ作業用の環境です。  
Docker コンテナによる BookStack サーバと、サポート用のC#スクリプトファイルを含んでいます。  

## ファイル一覧

各ファイルの簡単な説明を以下に記載します。  
基本的にはスクリプトを実行すればローカライズの作業準備が整う想定です。  

- docker/*
    - Dockerコンテナ環境用ファイル群。
- 00.delete-data.csx
    - コンテナ停止してボリュームと抽出データを削除するスクリプト。
    - 状態をリセットして最初からやり直すために使用します。
- 10.restart.csx
    - コンテナを(再)起動してテスト用トークンを作成するスクリプト。
- 20.make-test-entities.csx
    - BookStack 上にいくつかの確認用エンティティを作成するスクリプト。
    - 手間を省くためだけのものであるため、必ずしも必要なスクリプトではありません。
- 90.recv-webhook.csx
    - Webhookの受信サーバを実行する。
    - エンドポイントにPOSTされたJSONデータを表示します。
    - BookStack の Webhook 送信に関係する動作の確認用です。

## C#スクリプト

### 実行準備

C#スクリプトを実行するために以下をインストールする必要があります。  
- .NET 9.0 SDK
- dotnet-script v1.6.0 以降

.NET SDKは以下でダウンロード可能です。  
C#スクリプトは実行時にコンパイルが行われるため、RuntimeではなくSDKが必要であることに注意してください。  
- https://dotnet.microsoft.com/download

dotnet-script は .NET SDK のセットアップ後に以下を実行することでインストール可能です。  
```
dotnet tool install -g dotnet-script
```

### スクリプト実行

実行環境の準備が整ったら、以下のようにスクリプトを実行できます。  
初回実行ではスクリプトがコンパイルされるため、実行開始まである程度時間がかかります。  
```
dotnet script ./10.restart.csx
```

もし環境が Windows であれば、以下のコマンドで関連付けハンドラを登録できます。  
登録された `.NET Host` をスクリプトファイルに関連付けすることでダブルクリックなどでスクリプト実行できます。  
```
dotnet script register
```